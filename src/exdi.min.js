typeof window!="undefined"&&(window.exdi={}),function(a,b){function c(a){return typeof a=="function"||typeof a=="object"&&a instanceof Array&&a.length>0&&typeof a[a.length-1]=="function"?!0:!1}function d(a){b?setTimeout(function(){a()}):process.nextTick(a)}function e(a){var b=[],c=0;if(a instanceof Array){var c;for(c=0;c<a.length-1;c++){if(!(typeof a[c]=="string"||typeof a[c]===number&&!isNaN(a[c])&&isFinite(a[c])))throw new Error("Invalid array argument for getFunctionParametersNames(): "+String(a[c]));b.push(String(a[c]))}return b}var d=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,e=/\s*,\s*/,f=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,g,h,i;if(typeof a!="function")throw new Error("To extract parameters names you must provide a function");g=a.toString().replace(f,""),h=g.match(d),i=h[1].split(e);if(i.length)for(c=0;c<i.length;c++)i[c]&&b.push(i[c]);return b}function f(a){if(this instanceof f==0)return new f(a);var b=[],d=0,e,g=[],h=0,i=!1;e=function(){return b[d]&&d<b.length&&typeof c(b[d].fn)?(d++,b[d-1].params.exdiDone=e,a.execute(b[d-1].fn,b[d-1].params,b[d-1].context||a,!0),!1):(i&&clearTimeout(i),!0)},this.add=function(a,d,e){if(c(a))throw new Error("You can add only functions or array to queue");d instanceof Object==0&&(d={});if(!e||!(e instanceof Object))e=undefined;return b.push({fn:a,params:d,context:e}),this},this.on=function(a,b){a=String(a).toLowerCase();if(a!=="timeout")throw new Error("Unrecognized event "+String(a));if(c(b))throw new Error("Callback must be a function");if(a!=="timeout")throw new Error("Unrecognized event "+a+". Available events are: step, timeout and done.");return g.push(b),this},this.setTimeoutLimit=function(a){return h=Math.abs(parseInt(a,10)),this},this.clearQueue=function(){return b=[],this},this.execute=function(){d=0,e();if(h>0){var c=this;i=setTimeout(function(){e=function(){return!1};for(d=0;d<g.length;d++)a.execute(g[d],{},a,!0)},h)}return this},this.run=this.execute}function g(a){if(this instanceof g==0)return new g(a);var b={},d={},e=0,f=0,h=[],i=[],j=[],k=0,l=!1;this.add=function(g,j,k){if(c(g))throw new Error("You can add only functions to queue");j instanceof Object==0&&(j={});if(!k||!(k instanceof Object))k=undefined;return e++,function(c){j.exdiDone=function(){if(d[c]!==!1)return;d[c]=!0;var b=!0,e="";for(e in d)if(d.hasOwnProperty(e)&&d[e]===!1){b=!1;break}if(!b)for(f=0;f<h.length;f++)a.execute(h[f],{},a,!0);else{l&&clearTimeout(l);for(f=0;f<i.length;f++)a.execute(i[f],{},a,!0)}},b[c]={fn:g,params:j,context:k},d[c]=!1}("task"+String(e)),this},this.clearTasks=function(){return b={},e=0,this},this.on=function(a,b){a=String(a).toLowerCase();if(a!=="step"&&a!=="done"&&a!=="timeout")throw new Error("Unrecognized event "+String(a));if(c(b))throw new Error("Callback must be a function");if(a==="step")h.push(b);else if(a==="timeout")j.push(b);else{if(a!=="done")throw new Error("Unrecognized event "+a+". Available events are: step, timeout and done.");i.push(b)}return this},this.setTimeoutLimit=function(a){return k=Math.abs(parseInt(a,10)),this},this.execute=function(){var c="";for(c in b)d[c]=!1,a.execute(b[c].fn,b[c].params,b[c].context||a,!0);if(k>0){var g=this;l=setTimeout(function(){d={},b={},e=0;for(f=0;f<j.length;f++)a.execute(j[f],{},a,!0)},k)}return this},this.run=this.execute}function h(a){if(this instanceof h==0)return new h(a);a||(a={}),this.set=function(b,d){b=String(b);if(b.length===0||b==="exdi")throw new Error("Invalid name");if(/^[A-Z]/.test(b[0].toString())&&!c(d))throw new Error("All variables named using first capital letter are constructors and must have first capital letter.");return a[b]=d,this},this.get=function(b,d,e){b=String(b);if(b.length===0)throw new Error("Invalid name");return b==="exdi"?this:/^[A-Z]/.test(b[0].toString())&&c(a[b])?this.execute(a[b],d,e):a[b]===undefined?d:a[b]},this.delete=function(b){return b=String(b),delete a[b],this},this.execute=function(b,f,g,h){f||(f=[]);if(!c(b))throw new Error("You can only execute a function");var i,j=[],k=0,l=b instanceof Array?!0:!1;i=e(b);if(i.length>0)for(k=0;k<i.length;k++){if(f[i[k]]){j.push(f[i[k]]);continue}if(a[i[k]]){j.push(this.get(i[k]));continue}j.push(undefined)}return g=g instanceof Object?g:this,l&&(b=b[b.length-1]),h===!0?d(function(){b.apply(g,j)}):b.apply(g,j)},this.run=this.execute,this.createQueue=function(){return new f(this)},this.createParallel=function(){return new g(this)}}"use strict";var i={};a.get=function(a){return a=String(a),i[a]instanceof h==0&&(i[a]=new h),i[a]},a.all=function(){return i},a.delete=function(a){return a=String(a),delete i[a],this},a.create=function(){return new h},a.createContainer=a.create,a.createQueue=function(){return a.createContainer().createQueue()},a.createParallel=function(){return a.createContainer().createParallel()}}(typeof window=="undefined"?module.exports:window.exdi,typeof window=="undefined"?!1:!0);