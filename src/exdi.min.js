"undefined"!=typeof window&&(window.exdi={}),function(t,e){"use strict";function n(t){return"function"==typeof t||"object"==typeof t&&t instanceof Array&&t.length>0&&"function"==typeof t[t.length-1]?!0:!1}function r(t){e?setTimeout(function(){t()}):process.nextTick(t)}function i(t){var e=[],n=0;if(t instanceof Array){var n;for(n=0;n<t.length-1;n++){if("string"!=typeof t[n]&&(typeof t[n]!==number||isNaN(t[n])||!isFinite(t[n])))throw new Error("Invalid array argument for getFunctionParametersNames(): "+String(t[n]));e.push(String(t[n]))}return e}var r,i,o,u=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,a=/\s*,\s*/,s=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;if("function"!=typeof t)throw new Error("To extract parameters names you must provide a function");if(r=t.toString().replace(s,""),i=r.match(u),o=i[1].split(a),o.length)for(n=0;n<o.length;n++)o[n]&&e.push(o[n]);return e}function o(t){if(this instanceof o==!1)return new o(t);var e,r=[],i=0,u=[],a=0,s=!1;e=function(){return r[i]&&i<r.length?(i++,r[i-1].params.exdiDone=e,t.execute(r[i-1].fn,r[i-1].params,r[i-1].context||t,!0),!1):(s&&clearTimeout(s),!0)},this.add=function(t,e,i){if(n(t))throw new Error("You can add only functions or array to queue");return e instanceof Object==!1&&(e={}),i&&i instanceof Object||(i=void 0),r.push({fn:t,params:e,context:i}),this},this.on=function(t,e){if(t=String(t).toLowerCase(),"timeout"!==t)throw new Error("Unrecognized event "+String(t));if(n(e))throw new Error("Callback must be a function");if("timeout"!==t)throw new Error("Unrecognized event "+t+". Available events are: step, timeout and done.");return u.push(e),this},this.setTimeoutLimit=function(t){return a=Math.abs(parseInt(t,10)),this},this.clearQueue=function(){return r=[],this},this.execute=function(){if(i=0,e(),a>0){s=setTimeout(function(){for(e=function(){return!1},i=0;i<u.length;i++)t.execute(u[i],{},t,!0)},a)}return this},this.run=this.execute}function u(t){if(this instanceof u==!1)return new u(t);var e={},r={},i=0,o=0,a=[],s=[],c=[],f=0,h=!1;this.add=function(u,c,f){if(n(u))throw new Error("You can add only functions to queue");return c instanceof Object==!1&&(c={}),f&&f instanceof Object||(f=void 0),i++,function(n){c.exdiDone=function(){if(r[n]===!1){r[n]=!0;var e=!0,i="";for(i in r)if(r.hasOwnProperty(i)&&r[i]===!1){e=!1;break}if(e)for(h&&clearTimeout(h),o=0;o<s.length;o++)t.execute(s[o],{},t,!0);else for(o=0;o<a.length;o++)t.execute(a[o],{},t,!0)}},e[n]={fn:u,params:c,context:f},r[n]=!1}("task"+String(i)),this},this.clearTasks=function(){return e={},i=0,this},this.on=function(t,e){if(t=String(t).toLowerCase(),"step"!==t&&"done"!==t&&"timeout"!==t)throw new Error("Unrecognized event "+String(t));if(n(e))throw new Error("Callback must be a function");if("step"===t)a.push(e);else if("timeout"===t)c.push(e);else{if("done"!==t)throw new Error("Unrecognized event "+t+". Available events are: step, timeout and done.");s.push(e)}return this},this.setTimeoutLimit=function(t){return f=Math.abs(parseInt(t,10)),this},this.execute=function(){var n="";for(n in e)r[n]=!1,t.execute(e[n].fn,e[n].params,e[n].context||t,!0);if(f>0){h=setTimeout(function(){for(r={},e={},i=0,o=0;o<c.length;o++)t.execute(c[o],{},t,!0)},f)}return this},this.run=this.execute}function a(t){return this instanceof a==!1?new a(t):(t||(t={}),this.set=function(e,r){if(e=String(e),0===e.length||"exdi"===e)throw new Error("Invalid name");if(/^[A-Z]/.test(e[0].toString())&&!n(r))throw new Error("All variables named using first capital letter are constructors and must have first capital letter.");return t[e]=r,this},this.get=function(e,r,i){if(e=String(e),0===e.length)throw new Error("Invalid name");return"exdi"===e?this:/^[A-Z]/.test(e[0].toString())&&n(t[e])?this.execute(t[e],r,i):void 0===t[e]?r:t[e]},this.delete=function(e){return e=String(e),delete t[e],this},this.execute=function(e,o,u,a){if(o||(o=[]),!n(e))throw new Error("You can only execute a function");var s,c=[],f=0,h=e instanceof Array?!0:!1;if(s=i(e),s.length>0)for(f=0;f<s.length;f++)c.push(o[s[f]]?o[s[f]]:t[s[f]]?this.get(s[f]):void 0);return u=u instanceof Object?u:this,h&&(e=e[e.length-1]),a===!0?r(function(){e.apply(u,c)}):e.apply(u,c)},this.run=this.execute,this.createQueue=function(){return new o(this)},void(this.createParallel=function(){return new u(this)}))}var s={};t.get=function(t){return t=String(t),s[t]instanceof a==!1&&(s[t]=new a),s[t]},t.all=function(){return s},t.delete=function(t){return t=String(t),delete s[t],this},t.create=function(){return new a},t.createContainer=t.create,t.createQueue=function(){return t.createContainer().createQueue()},t.createParallel=function(){return t.createContainer().createParallel()}}("undefined"==typeof window?module.exports:window.exdi,"undefined"==typeof window?!1:!0);