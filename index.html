<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Exdi : Dependency injection container for JavaScript" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Exdi</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/dariuszp/exdi">View on GitHub</a>

          <h1 id="project_title">Exdi</h1>
          <h2 id="project_tagline">Dependency injection container for JavaScript</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/dariuszp/exdi/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/dariuszp/exdi/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="exdi-" class="anchor" href="#exdi-"><span class="octicon octicon-link"></span></a>exdi <a href="https://travis-ci.org/dariuszp/exdi"><img src="https://travis-ci.org/dariuszp/exdi.png?branch=master" alt="Build Status"></a>
</h1>

<h3>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h3>

<div class="highlight highlight-JavaScript"><pre><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">exdi</span>
</pre></div>

<p>After that, include exdi in Your file:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">var</span> <span class="nx">exdi</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'exdi'</span><span class="p">);</span>
</pre></div>

<h3>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Exdi is a dependency injection container. But whole library is practically a repository of containers.
There are two ways to create container:</p>

<p><em>Named container:</em></p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="nx">exdi</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'myContainer'</span><span class="p">);</span>
</pre></div>

<p>That will create new container and register it under "myContainer" name. So each time you ask for myContainer, same instance will be returned.</p>

<p>Or you can just spawn anonymous container using:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="nx">exdi</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
</pre></div>

<p>This will create unregisted container so there is no way to get it again from inside Exdi.</p>

<h3>
<a name="values-and-constructors" class="anchor" href="#values-and-constructors"><span class="octicon octicon-link"></span></a>Values and constructors</h3>

<p>Basic feature is to set and create container values. Using our "container" variable, we an do this like that:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'Will'</span><span class="p">);</span> <span class="c1">// this will set "name" variable with "Will" value.</span>
<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'surname'</span><span class="p">,</span> <span class="s1">'Smith'</span><span class="p">);</span> <span class="c1">// this will set "surname"</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'surname'</span><span class="p">);</span> <span class="c1">// this will return "Smith"</span>
</pre></div>

<p>Now, it would be not much of dependency injection container if we would not be able to build things using dependencies.</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'FullName'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">surname</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">surname</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>Constrution above will register a constructor. Constructors are executed each time you want to retreive them using .get() method.
So this code:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'FullName'</span><span class="p">);</span>
</pre></div>

<p>will return "Will Smith". There are few things to remember:</p>

<ul>
<li>
<em>First capital letter</em> is reserverd for constructors. It's <em>very important</em>. If key have capital letter as first sign, you can only set a function as value. This way that function will be executed each time you want to retreive it.</li>
<li>If you would use small letter and call it "fullName", code above would return registered function instead of result of that function.</li>
<li>Look how "name" and "surname" is handled. Exdi will extract parameters names and match them with container values. So there is no need for You to provide them. Just remember to have them in container before using constructor.</li>
<li>You can also pass other constructors as parameter. Like this:</li>
</ul><div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'age'</span><span class="p">,</span> <span class="s1">'27'</span><span class="p">);</span>
<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'AgeAndFullName'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">age</span><span class="p">,</span> <span class="nx">FullName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">FullName</span> <span class="o">+</span> <span class="s1">', age '</span> <span class="o">+</span> <span class="nx">age</span><span class="p">;</span>
<span class="p">})</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'AgeAndFullName'</span><span class="p">);</span> <span class="c1">// Will Smith, age 27</span>
</pre></div>

<h4>
<a name="remember" class="anchor" href="#remember"><span class="octicon octicon-link"></span></a>REMEMBER</h4>

<p>If you register function like this:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'FullName'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">surname</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">surname</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p><em>container.get('FullName')</em> will return result of a function since first capital letter means <em>Constructor</em>. This follow convention that most JS progremmers use.
So you will get "Will Smith". If you register function like this:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'fullName'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">surname</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">surname</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p><em>container.get('FullName')</em> will return whole function instead of executing it.</p>

<h3>
<a name="executing-any-function" class="anchor" href="#executing-any-function"><span class="octicon octicon-link"></span></a>Executing any function</h3>

<p>Sometimes you will want just execute one of Your functions without registering it in container. You can do it like this:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">add</span><span class="p">);</span> <span class="c1">// this will return 3</span>
</pre></div>

<p>And sometimes, you will want to overwrite some container values with Yours without changing them in container:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">add</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">y</span><span class="o">:</span> <span class="mi">5</span>
<span class="p">});</span> <span class="c1">// this will return 6. x is intact, y is replaced by 5 but only for execution of a function. Container value is intact.</span>
</pre></div>

<p>Also there is a problem of methods. Sometimes you have methods, functions that are part of bigger object and you want
to execute them BUT you don't want to loose object context. In other words, you don't want "this" pointing to something
else than that object. It's also possible like this:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">var</span> <span class="nx">myObj</span> <span class="o">=</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">z</span><span class="o">:</span> <span class="mi">4</span>
<span class="p">}</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="nx">container</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="nx">add</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">myObj</span><span class="p">);</span> <span class="c1">// this will return 7</span>
</pre></div>

<p>As you see, just provide object as third parameter and it will be used as context of execution.
If context object is not provided, "this" will point to container object. So inside your function
you can for example call</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'name'</span><span class="p">);</span> <span class="c1">// Will</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="queue-nad-parallel" class="anchor" href="#queue-nad-parallel"><span class="octicon octicon-link"></span></a>Queue nad Parallel</h3>

<p>Sometimes, you need to take control over code execution. It's hard to do since most of the time You will be dealing with
async functions. For that, Exdi have tools like Queue and Parallel. Both can be created using methods with the same names:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">var</span> <span class="nx">queue</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">createQueue</span><span class="p">();</span>
</pre></div>

<p>OR</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">var</span> <span class="nx">parallel</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">createParallel</span><span class="p">();</span>
</pre></div>

<p>Main difference between queue and paraller is simple. Queue will execute one function at that time in chain. So
second function in queue will be executed ONLY if first one is finished. Library will report when each step is done
and will also report using events that all steps are finished.</p>

<p>Parallel works in simmilar way but all functions will be called at the same time. It's like a "promise" pattern.</p>

<p>To add function to queue or parallel,, use .add() method:</p>

<div class="highlight highlight-JavaScript"><pre><span class="kd">function</span> <span class="nx">soSomethingCool</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">exdiDone</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'name'</span><span class="p">);</span> <span class="c1">// Will</span>
    <span class="c1">// here some async code</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
    <span class="nx">exdiDone</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">queue</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">soSomethingCool</span><span class="p">);</span>
<span class="c1">// or</span>
<span class="nx">parallel</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">soSomethingCool</span><span class="p">);</span>
</pre></div>

<p>to run either of them, you can use:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">queue</span><span class="p">.</span><span class="nx">execute</span><span class="p">();</span> <span class="c1">// will start queue</span>
<span class="nx">parallel</span><span class="p">.</span><span class="nx">execute</span><span class="p">();</span> <span class="c1">//will start parallel</span>
</pre></div>

<p>Functions passed to queue and parallel are quite different. Notice custom aprameter "exdiDone". It's a function that
You should call when it's finished. Remember we are dealing with async functions. So when you do what You have to do,
call:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">exdiDone</span><span class="p">();</span>
</pre></div>

<p>or next function will not be called in Queue and Parallel will never finish. You can register events for both libraries:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">queue</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'timeout'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="cm">/* too long */</span> <span class="p">});</span> <span class="c1">// called after X seconds</span>
</pre></div>

<p>Timeout is fired IF code execution takes too long. You can change default value (0) using <em>queue.setTimeoutLimit(5);</em></p>

<p>Same way, you can register events for parallel. There are two events available:</p>

<ul>
<li>step</li>
<li>done</li>
</ul><p>To cancel execution of both tools, use:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">queue</span><span class="p">.</span><span class="nx">clearQueue</span><span class="p">();</span> <span class="c1">// clear queue, function currently in execution will finish but next one will not be fired</span>
<span class="nx">queue</span><span class="p">.</span><span class="nx">clearTasks</span><span class="p">();</span> <span class="c1">// function can finish but step and done event wont called</span>
</pre></div>

<h3>
<a name="minified-code" class="anchor" href="#minified-code"><span class="octicon octicon-link"></span></a>Minified code</h3>

<p>Sometimes, programmers use tools that minify JavaScript code making it unreadable but short and small.
This will change variable names in Your code. So for example this:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'fullName'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">surname</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">surname</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>will look like this after minification:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'fullName'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>As You probably noticed, this will not work anymore. There is no 'a' and 'b' in our container. There is a way to fix that.</p>

<p>Just pass array first list of keys and function as last argument. This way, container will match function arguments based on
order and values of array keys instead of function arguments. Just like that:</p>

<div class="highlight highlight-JavaScript"><pre><span class="nx">container</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'fullName'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'surname'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
<span class="p">}]);</span>
</pre></div>

<p>Now Your cod work again.</p>

<h2>
<a name="remember-1" class="anchor" href="#remember-1"><span class="octicon octicon-link"></span></a>REMEMBER</h2>

<ul>
<li>always use small first letter when registering a value</li>
<li>when you set value with first capital letter, you need to pass function and when You try to retrive that key, function will be executed and result of that function will be returned</li>
<li>if you register function with small name, code of that function will be returned</li>
<li>queue will run one function at a time but parallel will start them all at once</li>
<li>you can pass array with keys and function as last argument to avoid problems with minification</li>
<li>you can register containers in exdi using .get('name') or create anonymous ones using .create()</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Exdi maintained by <a href="https://github.com/dariuszp">dariuszp</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
